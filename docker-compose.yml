version: '3'

services:

  lb:
    build: services/lb
    ports: ['${HTTP_PORT}:80']
    links: ['osticket', 'redmine']

  osticket:
    image: campbellsoftwaresolutions/osticket
    env_file: ['osticket.env']
    environment: ['INSTALL_EMAIL=${ADMIN_EMAIL}']
    links: ['osticket_db']

  osticket_db:
    image: mysql:5
    env_file: ['osticket.env']
    volumes: ['./volumes/osticket_db:/var/lib/mysql']

  redmine:
    image: redmine

  smtp:
    image: namshi/smtp
    environment: ['GMAIL_USER=${GMAIL_USER}', 'GMAIL_PASSWORD=${GMAIL_PASSWORD}']

  backup:
    image: javanile/backup
    volumes:
      - './backup:/backup/backup'
      - './osticket.env:/backup/services/osticket'
